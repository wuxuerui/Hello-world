#include <STC12C5.H>

#define uint unsigned int
	#define uchar unsigned char
//LCD12864????
//sbit LCD12864_CS    = P3^5;//????
sbit LCD12864_SID   = P0^0;//????
sbit LCD12864_SCLK  = P0^1;//????
//sbit LCD12864_RST   = P3^7;//????

/********************************************************************
* ?? : LCD12864_Delay()
* ?? : ??
* ?? : z
* ?? : ?
***********************************************************************/
void LCD12864_Delay(uint z)
{
//	uchar i;
//	while(z --) for(i = 0;i < 120;i ++);
	uint a,b;
 	for(a=0; a<z; a++)
   		for(b=0; b<120; b++);
}
/********************************************************************
* ?? : LCD12864_sendbyte
* ?? : ???????????,????
* ?? : zdata
* ?? : ?
***********************************************************************/
void LCD12864_SendByte(uchar zdata)
{
	uchar i;
	for(i = 0;i < 8;i ++)
	{
		if((zdata<<i) & 0x80)
		{
			LCD12864_SID = 1;
		}
		else
		{
		    LCD12864_SID = 0;
		}
		LCD12864_SCLK = 0;
		LCD12864_SCLK = 1;	
	}	
}
/********************************************************************
* ?? : LCD12864_write_com()
* ?? : ?????,??????
* ?? : com
* ?? : ?
***********************************************************************/
void  LCD12864_WriteCom(uchar com)
{
	  //LCD12864_CS = 1;//????,?????
	  LCD12864_SendByte(0xf8); //????
	  LCD12864_SendByte(com & 0xf0);	 //????
	  LCD12864_SendByte((com << 4) & 0xf0);//????
}

/********************************************************************
* ?? : LCD12864_write_date()
* ?? : ?????
* ?? : date
* ?? : ?
***********************************************************************/
void LCD12864_WriteDate(uchar date)
{
	//LCD12864_CS = 1; //????
	LCD12864_SendByte(0xfa);//????
    LCD12864_SendByte(date & 0xf0);	 //????
	LCD12864_SendByte((date << 4) & 0xf0);//????
}
/********************************************************************
* ?? : LCD12864_init()
* ?? : 12864?????
* ?? : com
* ?? : ?
***********************************************************************/
void LCD12864_Init()
{
  	 //LCD12864_RST = 0;
	 LCD12864_Delay(100);
	 //LCD12864_RST = 1;
	 LCD12864_Delay(100);
	 //LCD12864_WriteCom(0x34);//??????? ,?????
	 LCD12864_WriteCom(0x30);//???????, ?????
	 LCD12864_WriteCom(0x0c);//???,??????????
	 LCD12864_WriteCom(0x01);//??
	 LCD12864_Delay(100);
	 	 
}
/********************************************************************
* ?? :LCD_clean_scans()
* ?? : ??
* ?? : ?
* ?? : ?
***********************************************************************/
void LCD12864_CleanScans()
{
 	 LCD12864_WriteCom(0x01);//??
}
/********************************************************************
* ?? :  LCD12864_pos()
* ?? : ??????
* ?? :  x,y
* ?? : ?
***********************************************************************/
void LCD12864_SetPos(uchar x,uchar y)
{
	uchar pos;
	if(x == 0)
        	x = 0x80;
	else if(x == 1)
	        x = 0x90;
	else if(x == 2)
	        x = 0x88;
	else if(x == 3)
		    x = 0x98;
	pos = x + y;
	LCD12864_WriteCom(pos);//????		
}
/********************************************************************
* ?? : LCD12864_dishz()
* ?? : ?????
* ?? : *s
* ?? : ?
***********************************************************************/
void LCD12864_DisplayString(uchar *s)
{  
	uchar  i = 0;
	while(s[i]!= "/0")
    { 
		LCD12864_WriteDate(s[i]);
		i++;
	 	LCD12864_Delay(5);
    }
}
void main()
{
	LCD12864_Init();
	LCD_clean_scans();
	LCD12864_SetPos(1,1);
	LCD12864_DisplayString("abcd");
	while(1);
}